<h1> Installation Requirements </h1>
<p style="text-align: right;"><em>Edge for Private Cloud v. 4.17.05</em></p>
<h2>Hardware Requirements</h2>
<p>You must meet the basic hardware configurations that support the basic host installation. For all installation scenarios described above, the following tables list the minimum hardware requirements for the installation components.&nbsp;</p>
<p>In these tables the hard disk requirements are in addition to the hard disk space required by the operating system. Depending on your applications and network traffic, your installation might require more or fewer resources than listed below.</p>
<table class="table">
	<thead>
		<tr>
			<th>
				<p><strong>Installation Component</strong></p>
			</th>
			<th>
				<p><strong>RAM</strong></p>
			</th>
			<th>
				<p><strong>CPU</strong></p>
			</th>
			<th>
				<p><strong>Minimum hard disk</strong></p>
			</th>
		</tr>
	</thead>
	<tbody>
		<tr>
			<td>
				<p>Cassandra</p>
			</td>
			<td>
				<p>16GB</p>
			</td>
			<td>
				<p>8?core</p>
			</td>
			<td>
				<p>250GB local storage with SSD or fast HDD supporting 2000 IOPS</p>
			</td>
		</tr>
		<tr>
			<td>
				<p>Message Processor/Router on same machine</p>
			</td>
			<td>
				<p>8/16GB</p>
			</td>
			<td>
				<p>4/8?core</p>
			</td>
			<td>
				<p>100GB</p>
			</td>
		</tr>
		<tr>
			<td>
				<p>Analytics - Postgres/Qpid on same server (not recommended for production)</p>
			</td>
			<td>
				<p>16GB*</p>
			</td>
			<td>
				<p>8-core*</p>
			</td>
			<td>
				<p>500GB - 1TB** network storage***, preferably with SSD backend, supporting&nbsp;1000 IOPS or higher*.</p>
			</td>
		</tr>
		<tr>
			<td>
				<p>Analytics - Postgres standalone</p>
			</td>
			<td>
				<p>16GB*</p>
			</td>
			<td>
				<p>8-core*</p>
			</td>
			<td>
				<p>500GB - 1TB** network storage***, preferably with SSD backend, supporting&nbsp;1000&nbsp;IOPS&nbsp;or higher*.</p>
			</td>
		</tr>
		<tr>
			<td>
				<p>Analytics - Qpid standalone</p>
			</td>
			<td>
				<p>8GB</p>
			</td>
			<td>
				<p>4-core</p>
			</td>
			<td>
				<p>30GB - 50GB local storage with SSD or fast HDD</p>
				<p>For installations greater than 250 TPS, HDD with local storage supporting 1000 IOPS is recommended.</p>
				<p>The default Qpid queue size is 20 GB. If you need to add more capacity, add additional Qpid nodes.</p>
			</td>
		</tr>
		<tr>
			<td>
				<p>Other (OpenLDAP, UI, Management Server)</p>
			</td>
			<td>
				<p>4GB</p>
			</td>
			<td>
				<p>2-core</p>
			</td>
			<td>
				<p>60GB</p>
			</td>
		</tr>
		<tr>
			<td colspan="4">
				<p>*Adjust Postgres system requirements based on throughput:</p>
				<ul>
					<li>Less than 250 TPS: 8GB, 4-core can be considered with managed network storage*** supporting 1000 IOPS&nbsp;or higher</li>
					<li>Greater than 250 TPS: 16GB, 8-core, managed network storage*** supporting 1000 IOPS&nbsp;or higher</li>
					<li>Greater than 1000 TPS: 16GB, 8-core, managed network storage*** supporting 2000 IOPS&nbsp;or higher</li>
					<li>Greater than 2000 TPS: 32GB, 16-core, managed network storage*** supporting 2000 IOPS or higher&nbsp;</li>
					<li>Greater than 4000 TPS: 64GB, 32-core, managed network storage*** supporting 4000 IOPS or higher</li>
				</ul>
			</td>
		</tr>
		<tr>
			<td colspan="4">
				<p>**The Postgres hard disk value is based on the out of the box analytics captured by Edge. If you add custom values to the analytics data, then these values should be increased accordingly. Use the following formula to estimate the required storage:<br />
					<br />
					(# bytes/request) * (requests per second) * (seconds per hour) * (hours of peak usage per day) * (days per month) * (months of data retention) = bytes of storage needed<br />
					<br />
					For example:<br />
					<br />
					(500 bytes of analytics data per request) * 100 req/sec * 3600 secs/hr * 18 hours peak usage per day * 30 days/month * 3 months retention = 291,600,000,000 bytes or 292 GB.</p>
			</td>
		</tr>
		<tr>
			<td colspan="4">
				<p>*** Network Storage is recommended for Postgresql database because:&nbsp;</p>
				<ul>
					<li>It gives the ability to dynamically scale up the storage size if and when required.</li>
					<li>Network IOPS can be adjusted on the fly in most of today’s environment/Storage/Network subsystems.</li>
					<li>Storage level snapshots can be enabled as part of backup and recovery solutions.</li>
				</ul>
			</td>
		</tr>
	</tbody>
</table>
<p>In addition, the following lists the hardware requirements if you wish to install the Monetization Services:</p>
<table class="table">
	<thead>
		<tr>
			<th>
				<p><strong>Component with Monetization</strong></p>
			</th>
			<th>
				<p><strong>RAM</strong></p>
			</th>
			<th>
				<p><strong>CPU</strong></p>
			</th>
			<th>
				<p><strong>Hard disk</strong></p>
			</th>
		</tr>
	</thead>
	<tbody>
		<tr>
			<td>
				<p>Management Server (with Monetization Services)</p>
			</td>
			<td>
				<p>8GB</p>
			</td>
			<td>
				<p>4?core</p>
			</td>
			<td>
				<p>60GB</p>
			</td>
		</tr>
		<tr>
			<td>
				<p>Analytics - Postgres/Qpid on same server</p>
			</td>
			<td>
				<p>16GB</p>
			</td>
			<td>
				<p>8-core</p>
			</td>
			<td>
				<p>500GB - 1TB network storage, preferably with SSD backend, supporting 1000 IOPS or higher, or use the rule from the table above.</p>
			</td>
		</tr>
		<tr>
			<td>
				<p>Analytics - Postgres standalone</p>
			</td>
			<td>
				<p>16GB</p>
			</td>
			<td>
				<p>8-core</p>
			</td>
			<td>
				<p>500GB - 1TB network storage, preferably with SSD backend, supporting 1000 IOPS or higher, or use the rule from the table above.</p>
			</td>
		</tr>
		<tr>
			<td>
				<p>Analytics - Qpid standalone</p>
			</td>
			<td>
				<p>8GB</p>
			</td>
			<td>
				<p>4-core</p>
			</td>
			<td>
				<p>40GB - 500GB local storage with SSD or fast HDD</p>
				<p>For installations greater than 250 TPS, HDD with local storage supporting 1000 IOPS is recommended.</p>
			</td>
		</tr>
	</tbody>
</table>
<p>The following lists the hardware requirements if you wish to install API BaaS:</p>
<table class="table">
	<tbody>
		<tr>
			<th>
				<p><strong>API BaaS Component</strong></p>
			</th>
			<th>
				<p><strong>RAM</strong></p>
			</th>
			<th>
				<p><strong>CPU</strong></p>
			</th>
			<th>
				<p><strong>Hard disk</strong></p>
			</th>
		</tr>
		<tr>
			<td>
				<p>ElasticSearch*</p>
			</td>
			<td>
				<p>8GB</p>
			</td>
			<td>
				<p>4?core</p>
			</td>
			<td>
				<p>60 - 80GB</p>
			</td>
		</tr>
		<tr>
			<td>
				<p>API BaaS Stack *</p>
			</td>
			<td>
				<p>8GB</p>
			</td>
			<td>
				<p>4?core</p>
			</td>
			<td>
				<p>60 - 80GB</p>
			</td>
		</tr>
		<tr>
			<td>
				<p>API BaaS Portal</p>
			</td>
			<td>
				<p>1GB</p>
			</td>
			<td>
				<p>2-core</p>
			</td>
			<td>
				<p>20GB</p>
			</td>
		</tr>
		<tr>
			<td>
				<p>Cassandra (Optional — typically you use the same Cassandra cluster for both Edge and API BaaS Services)</p>
			</td>
			<td>
				<p>16GB</p>
			</td>
			<td>
				<p>8-core</p>
			</td>
			<td>
				<p>250GB local storage with SSD or fast HDD supporting 2000 IOPS</p>
			</td>
		</tr>
		<tr>
			<td colspan="4">
				<p>* You can install ElasticSearch and API BaaS Stack on the same node. If you do, configure ElasticSearch to use 4GB of memory (default). If ElasticSearch is installed on its own node, then configure it to use 6GB of memory.</p>
			</td>
		</tr>
	</tbody>
</table>
<p><strong>Note</strong>:&nbsp;</p>
<ul>
	<li>If the root file system is not large enough for the installation, it is recommended to place the data onto a larger disk.</li>
	<li>If an older version of Apigee Edge for Private Cloud was installed on the machine, ensure that you delete the folder <span style="font-family:courier new,courier,monospace;">/tmp/java</span> before a new installation.</li>
	<li>The system wide temporary folder <span style="font-family:courier new,courier,monospace;">/tmp</span> needs execute permissions in order to start Cassandra.</li>
	<li>If user “apigee” was created prior to the installation, ensure that “/home/apigee” exists as home directory and is owned by “apigee:apigee”.</li>
</ul>
<h2>Operating System and third-party software requirements</h2>
<p>These installation instructions and the supplied installation files have been tested on the operating systems and third-party software listed here: <a href="https://apigee.com/docs/api-services/reference/supported-software">https://apigee.com/docs/api-services/reference/supported-software</a>.</p>
<h2>Creating the apigee user</h2>
<p>The installation procedure creates a Unix system user named 'apigee'. Edge directories and files are owned by 'apigee', as are Edge processes. That means Edge components run as the 'apigee' user. if necessary, you can run components as a different user. See "Binding the Router to a protected port" in <a href="http://docs.apigee.com/node/19901">http://docs.apigee.com/node/19901</a> for an example.&nbsp;</p>
<h2>Installation directory</h2>
<p>By default, the installer writes all files to the <span style="font-family:courier new,courier,monospace;">/opt/apigee</span> directory. You cannot change this directory location. While you cannot change this directory, you can create a symlink to map <span style="font-family: &quot;courier new&quot;, courier, monospace;">/opt/apigee</span> to another location, as described below.</p>
<p>In the instructions in this guide, the installation directory is noted as <span style="font-family:courier new,courier,monospace;">/&lt;inst_root&gt;/apigee</span>, where <span style="font-family:courier new,courier,monospace;">/&lt;inst_root&gt;</span> is <span style="font-family:courier new,courier,monospace;">/opt</span> by default.</p>
<h3>Creating a symlink from /opt/apigee</h3>
<p>Before you create the symlink, you must first create a user and group named "apigee". This is the same group and user created by the Edge installer.&nbsp;</p>
<p>To create the symlink, perform these steps before downloading the bootstrap_4.17.01.sh file. You must perform all of these steps as root:</p>
<ol>
	<li>Create the "apigee" user and group:<br />
		<span style="font-family: &quot;courier new&quot;, courier, monospace;">&gt; groupadd -r apigee<br />
		&gt; useradd -r -g apigee -d /opt/apigee -s /sbin/nologin -c "Apigee platform user" apigee</span></li>
	<li>Create a symlink from <span style="font-family:courier new,courier,monospace;">/opt/apigee</span> to your desired install root:<br />
		<span style="font-family: &quot;courier new&quot;, courier, monospace;">&gt; ln -Ts&nbsp;<em><strong>/srv/myInstallDir</strong></em>&nbsp;/opt/apigee</span><br />
		where&nbsp;<em><strong>/srv/myInstallDir</strong></em>&nbsp;is the desired location of the Edge files.&nbsp;</li>
	<li>Change ownership of the install root and symlink to the "apigee" user:<br />
		<span style="font-family: &quot;courier new&quot;, courier, monospace;">&gt; chown -h apigee:apigee&nbsp;<em><strong>/srv/myInstallDir</strong></em>&nbsp;/opt/apigee</span></li>
</ol>
<h2>Java</h2>
<p>You need a supported version of Java1.8 installed on each machine prior to the installation. Supported JDKs are listed here:&nbsp;</p>
<p><a href="https://apigee.com/docs/api-services/reference/supported-software">https://apigee.com/docs/api-services/reference/supported-software</a></p>
<p>Ensure that <span style="font-family:courier new,courier,monospace;">JAVA_HOME</span> points to the root of the JDK for the user performing the installation.</p>
<h2>SELinux</h2>
<p>Depending on your settings for SELinux, Edge can encounter issues with installing and starting Edge components. If necessary, you can disable SELinux or set it to permissive mode during installation, and then re-enabling it after installation. See <a href="http://docs.apigee.com/node/19896">http://docs.apigee.com/node/19896</a> for more.</p>
<h2>Network Setting</h2>
<p>It is recommended to check the network setting prior to the installation. The installer expects that all machines have fixed IP addresses. Use the following commands to validate the setting:</p>
<ul>
	<li><span style="font-family:courier new,courier,monospace;">hostname</span> returns the name of the machine</li>
	<li><span style="font-family:courier new,courier,monospace;">hostname -i</span> returns the IP address for the hostname that can be addressed from other machines.&nbsp;</li>
</ul>
<p>Depending on your operating system type and version, you might have to edit <span style="font-family:courier new,courier,monospace;">/etc/hosts</span> and <span style="font-family:courier new,courier,monospace;">/etc/sysconfig/network</span> if the hostname is not set correctly. See the documentation for your specific operating system for more information.</p>
<h3>TCP Wrappers</h3>
<p>TCP Wrappers can block communication of some ports and can affect OpenLDAP, Postgres, and Cassandra installation. On those nodes, check&nbsp;<span style="font-family: &quot;courier new&quot;, courier, monospace;">/etc/hosts.allow</span>&nbsp;and&nbsp;<span style="font-family: &quot;courier new&quot;, courier, monospace;">/etc/hosts.deny</span>&nbsp;to ensure that there are no port restrictions on the required OpenLDAP, Postgres, and Cassandra ports.</p>
<h3>iptables</h3>
<p>Validate that there are no iptables policies preventing connectivity between nodes on the required Edge ports. If necessary, you can stop iptables during installation using the command:</p>
<pre>
&gt; sudo/etc/init.d/iptables stop</pre>
<p>On CentOS 7.x:</p>
<pre>
&gt; systemctl stop firewalld</pre>
<h2>Ensure Edge Router can access&nbsp;/etc/rc.d/init.d/functions</h2>
<p>The Edge Router and BaaS Portal nodes use the Nginx router and require read access to&nbsp;<span style="font-family: &quot;courier new&quot;, courier, monospace;">/etc/rc.d/init.d/functions</span>.</p>
<p>If your security process requires you to set permissions on&nbsp;<span style="font-family: &quot;courier new&quot;, courier, monospace;">/etc/rc.d/init.d/functions</span>, do not set them to 700 or else the router will fail to start. Permissions can be set to 744 to allow read access to&nbsp;<span style="font-family: &quot;courier new&quot;, courier, monospace;">/etc/rc.d/init.d/functions</span>.</p>
<h2>Cassandra&nbsp;</h2>
<p>All Cassandra nodes have to be connected to a ring.&nbsp;Cassandra stores data replicas on multiple nodes to ensure reliability and fault tolerance. The replication strategy for each Edge&nbsp;keyspace&nbsp;determines the Cassandra nodes where replicas are placed. For more,see <a href="http://docs.apigee.com/node/22886">http://docs.apigee.com/node/22886</a>.</p>
<p>Cassandra automatically adjusts its Java heap size based on the available memory. For more, see <a href="https://docs.datastax.com/en/cassandra/2.0/cassandra/operations/ops_tune_jvm_c.html">Tuning Java resources</a>. In the event of a performance degradation or high memory consumption.&nbsp;</p>
<p>After installing the Edge for Private Cloud, you can check that Cassandra is configured correctly by examining the <span style="font-family:courier new,courier,monospace;">/&lt;inst_root&gt;/apigee/apigee-cassandra/conf/cassandra.yaml</span> file. For example, ensure that the Edge for Private Cloud installation script set the following properties:</p>
<ul>
	<li><span style="font-family:courier new,courier,monospace;">cluster_name&nbsp;</span></li>
	<li><span style="font-family:courier new,courier,monospace;">initial_token&nbsp;</span></li>
	<li><span style="font-family:courier new,courier,monospace;">partitioner&nbsp;</span></li>
	<li><span style="font-family:courier new,courier,monospace;">seeds</span></li>
	<li><span style="font-family:courier new,courier,monospace;">listen_address&nbsp;</span></li>
	<li><span style="font-family:courier new,courier,monospace;">rpc_address&nbsp;</span></li>
	<li><span style="font-family:courier new,courier,monospace;">snitch&nbsp;</span></li>
</ul>
<p><strong>Warning</strong>: Do not edit this file.&nbsp;</p>
<h2>PostgreSQL database</h2>
<p>After you install Edge, you can adjust the following PostgreSQL database settings based on the amount of RAM available on your system:</p>
<pre>
conf_postgresql_shared_buffers = 35% of RAM      # min 128kB
conf_postgresql_effective_cache_size = 45% of RAM
conf_postgresql_work_mem = 512MB       # min 64kB</pre>
<div class="note">
	<p>These settings assume that the PostgreSQL database is only used for Edge analytics, and not for any other purpose.&nbsp;</p>
</div>
<p>To set these values:</p>
<ol>
	<li>Edit postgresql.properties:<br />
		<span style="font-family:courier new,courier,monospace;">&gt; vi /&lt;inst_root&gt;/apigee/customer/application/postgresql.properties</span><br />
		<br />
		If the file does not exist, create it.</li>
	<li>Set the properties listed above.</li>
	<li>Save your edits.</li>
	<li>Restart the PostgreSQL database:<br />
		<span style="font-family:courier new,courier,monospace;">&gt; /&lt;inst_root&gt;/apigee/apigee-service/bin/apigee-service apigee-postgresql restart</span></li>
</ol>
<h2>System limits</h2>
<p>Ensure that you have set the following system limits on Cassandra and Message Processor nodes:</p>
<ul>
	<li>On Cassandra nodes, set soft and hard memlock, nofile, and address space (as) limits for installation user (default is “apigee") in&nbsp;<span style="font-family: &quot;courier new&quot;, courier, monospace;">/etc/security/limits.conf&nbsp;</span>as shown below:<br />
		<span style="font-family: &quot;courier new&quot;, courier, monospace;">apigee soft memlock unlimited<br />
		apigee hard memlock unlimited<br />
		apigee soft nofile 32768<br />
		apigee hard nofile 65536<br />
		apigee soft as unlimited<br />
		apigee hard as unlimited</span><br />
		&nbsp;</li>
	<li>On Message Processor nodes, set the maximum number of open file descriptors to 64K by using the command:<br />
		<span style="font-family: &quot;courier new&quot;, courier, monospace;">&gt; ulimit -n 65535</span><br />
		<br />
		If necessary, you can raise that limit. For example, if you have a large number of temporary files open at any one time.</li>
</ul>
<h2>jsvc</h2>
<p>"jsvc" is a prerequisite for using API BaaS. Version 1.0.15-dev is installed when you install the API BaaS.</p>
<h2>Network Security Services (NSS)</h2>
<p>Network Security Services (NSS) is a set of libraries that supports development of security-enabled client and server applications. You should ensure that you have installed NSS v3.19, or later.&nbsp;</p>
<p>To check your current version:</p>
<pre>
&gt; yum info nss</pre>
<p>To update NSS:</p>
<pre>
&gt; yum update nss</pre>
<p>See <a href="https://rhn.redhat.com/errata/RHSA-2015-1981.html">this article</a> from RedHat for more information.</p>
<h2>Disable DNS lookup on IPv6 when using&nbsp;NSCD (Name Service Cache Daemon)&nbsp;</h2>
<p>If you have installed and enabled NSCD (Name Service Cache Daemon) the Message Processors makes two DNS lookups: one for IPv4 and one for IPv6. You should disable DNS lookup on IPv6&nbsp;when using NSCD.</p>
<p>To disable the DNS lookup on IPv6:</p>
<ol>
	<li>On every Message Processor node, edit <span style="font-family:courier new,courier,monospace;">/etc/nscd.conf</span></li>
	<li>Set the following property:<br />
		<span style="font-family:courier new,courier,monospace;">enable-cache hosts no</span></li>
</ol>
<h2>AWS AMI</h2>
<p>If you are installing Edge on an AWS Amazon Machine Image (AMI) for Red Hat Enterprise Linux 7.x, you must first run the following command:</p>
<pre>
&gt; yum-config-manager --enable rhui-REGION-rhel-server-extras rhui-REGION-rhel-server-optional</pre>
<h2>Tools</h2>
<p>The installer uses the following UNIX tools in the standard version as provided by EL5 or EL6.</p>
<table class="table">
	<tbody>
		<tr>
			<td>
				<p>awk</p>
			</td>
			<td>
				<p>expr</p>
			</td>
			<td>
				<p>lua-socket</p>
			</td>
			<td>
				<p>rpm</p>
			</td>
			<td>
				<p>unzip</p>
			</td>
		</tr>
		<tr>
			<td>
				<p>basename</p>
			</td>
			<td>
				<p>grep</p>
			</td>
			<td>
				<p>ls</p>
			</td>
			<td>
				<p>rpm2cpio</p>
			</td>
			<td>
				<p>useradd</p>
			</td>
		</tr>
		<tr>
			<td>
				<p>bash</p>
			</td>
			<td>
				<p>hostname</p>
			</td>
			<td>
				<p>net-tools</p>
			</td>
			<td>
				<p>sed</p>
			</td>
			<td>
				<p>wc</p>
			</td>
		</tr>
		<tr>
			<td>
				<p>bc</p>
			</td>
			<td>
				<p>id</p>
			</td>
			<td>
				<p>perl (from procps)</p>
			</td>
			<td>
				<p>sudo</p>
			</td>
			<td>
				<p>wget</p>
			</td>
		</tr>
		<tr>
			<td>
				<p>curl</p>
			</td>
			<td>
				<p>libaio</p>
			</td>
			<td>
				<p>pgrep&nbsp;(from procps)</p>
			</td>
			<td>
				<p>tar</p>
			</td>
			<td>
				<p>xerces-c</p>
			</td>
		</tr>
		<tr>
			<td>
				<div>cyrus-sasl</div>
			</td>
			<td>
				<div>libdb-cxx</div>
			</td>
			<td>ps</td>
			<td>tr</td>
			<td>yum</td>
		</tr>
		<tr>
			<td>
				<p>date</p>
			</td>
			<td>
				<div>libibverbs&nbsp;</div>
			</td>
			<td>
				<p>pwd</p>
			</td>
			<td>
				<p>uuid</p>
			</td>
			<td>
				<p>chkconfig</p>
			</td>
		</tr>
		<tr>
			<td>dirname</td>
			<td>
				<div>librdmacm&nbsp;</div>
			</td>
			<td>python</td>
			<td>uname</td>
			<td>&nbsp;</td>
		</tr>
		<tr>
			<td>echo</td>
			<td>
				<div>libxslt</div>
			</td>
			<td>&nbsp;</td>
			<td>&nbsp;</td>
			<td>&nbsp;</td>
		</tr>
	</tbody>
</table>
<p>Note:</p>
<ul>
	<li>The executable for the tool ‘useradd’ is located in <span style="font-family:courier new,courier,monospace;">/usr/sbin</span> and for chkconfig in <span style="font-family:courier new,courier,monospace;">/sbin</span>.</li>
	<li>With sudo access you can gain access over the environment of the calling user, for example, usually you would call “<span style="font-family:courier new,courier,monospace;">sudo</span><span style="font-family:courier new,courier,monospace;"> &lt;command&gt;</span>” or &nbsp;“<span style="font-family:courier new,courier,monospace;">sudo PATH=$PATH:/usr/sbin:/sbin &lt;command&gt;</span>”.</li>
	<li>Ensure that you have “patch” tool installed prior to a service pack (patch) installation.</li>
</ul>
<p><strong>ntpdate</strong> – It is recommended to have the servers time synchronized. If not already configured, ‘ntpdate’ utility could serve this purpose, which verifies whether servers are time synchronized. You can use “<span style="font-family:courier new,courier,monospace;">yum install ntp</span>” to install the utility. This is particularly useful for replicating OpenLDAP setups. Note that you set up server time zone in UTC.</p>
<p><strong>openldap 2.4</strong> – The on-premises installation requires OpenLDAP 2.4. If your server has an Internet connection, then the Edge install script downloads and installs OpenLDAP. If your server does not have an Internet connection, you must ensure that OpenLDAP is already installed before running the Edge install script. On RHEL/CentOS, you can run "<span style="font-family:courier new,courier,monospace;">yum install openldap-clients openldap-servers</span>" to install the OpenLDAP.&nbsp;</p>
<p>For 13-host installations, and 12-host installations with two Data Centers, you require OpenLDAP replication because there are multiple nodes hosting OpenLDAP.</p>
<h2>Firewalls and Virtual Hosts</h2>
<p>The term “virtual” commonly gets overloaded in the IT arena, and so it is with an Apigee Edge for Private Cloud deployment and virtual hosts. To clarify, there are two primary uses of the term “virtual”:</p>
<ul>
	<li><strong>Virtual machines (VM)</strong>: Not required, but some deployment use VM technology to create isolated servers for their Apigee components. VM hosts, like physical hosts, can have network interfaces and firewalls.&nbsp;</li>
	<li><strong>Virtual hosts</strong>: Web endpoints, analogous to an Apache virtual host.</li>
</ul>
<p>A router in a VM can expose multiple virtual hosts (as long as they differ from one another in their host alias or in their interface port).</p>
<p>Just as a naming example, a single physical server “A” might be running two VMs, named “VM1” and “VM2”. Let’s assume VM1 exposes a virtual Ethernet interface, which gets named <span style="font-family:courier new,courier,monospace;">eth0</span> inside the VM, and which is assigned IP address <span style="font-family:courier new,courier,monospace;">111.111.111.111</span> by the virtualization machinery or a network DHCP server; and then assume VM2 exposes a virtual Ethernet interface also named eth0 and it gets assigned an IP address <span style="font-family:courier new,courier,monospace;">111.111.111.222</span>.</p>
<p>We might have an Apigee router running in each of the two VMs. The routers expose virtual host endpoints as in this hypothetical example:</p>
<p>The Apigee router in VM1 exposes three virtual hosts on its eth0 interface (which has some specific IP address), api.mycompany.com:80, <span style="font-family:courier new,courier,monospace;">api.mycompany.com:443</span>, and <span style="font-family:courier new,courier,monospace;">test.mycompany.com:80</span>.</p>
<p>The router in VM2 exposes <span style="font-family:courier new,courier,monospace;">api.mycompany.com:80</span> (same name and port as exposed by VM1).</p>
<p>The physical host’s operating system might have a network firewall; if so, that firewall must be configured to pass TCP traffic bound for the ports being exposed on the virtualized interfaces (<span style="font-family:courier new,courier,monospace;">111.111.111.111:{80, 443}</span> and <span style="font-family:courier new,courier,monospace;">111.111.111.222:80</span>). In addition, each VM’s operating system may provide its own firewall on its eth0 interface and these too must allow ports <span style="font-family:courier new,courier,monospace;">80</span> and <span style="font-family:courier new,courier,monospace;">443</span> traffic to connect.</p>
<p>The basepath is the third component involved in routing API calls to different API proxies that you may have deployed. API proxy bundles can share an endpoint if they have different basepaths. For example, one basepath can be defined as <span style="font-family:courier new,courier,monospace;">http://api.mycompany.com:80/</span> and another defined as <span style="font-family:courier new,courier,monospace;">http://api.mycompany.com:80/salesdemo</span>.</p>
<p>In this case, you need a load balancer or traffic director of some kind splitting the http://api.mycompany.com:80/ traffic between the two IP addresses (<span style="font-family:courier new,courier,monospace;">111.111.111.111</span> on VM1 and <span style="font-family:courier new,courier,monospace;">111.111.111.222</span> on VM2). This function is specific to your particular installation, and is configured by your local networking group.</p>
<p>The basepath is set when you deploy an API. From the above example, you can deploy two APIs, <span style="font-family:courier new,courier,monospace;">mycompany</span> and <span style="font-family:courier new,courier,monospace;">testmycompany</span>, for the organization <span style="font-family:courier new,courier,monospace;">mycompany-org</span> with the virtual host that has the host alias of <span style="font-family:courier new,courier,monospace;">api.mycompany.com</span> and the port set to <span style="font-family:courier new,courier,monospace;">80</span>. If you do not declare a basepath in the deployment, then the router does not know which API to send incoming requests to.&nbsp;</p>
<p>However, if you deploy the API <span style="font-family:courier new,courier,monospace;">testmycompany</span> with the base URL of <span style="font-family:courier new,courier,monospace;">/salesdemo</span>, then users access that API using <span style="font-family:courier new,courier,monospace;">http://api.mycompany.com:80/salesdemo</span>. If you deploy your API mycompany with the base URL of / then your users access the API by the URL <span style="font-family:courier new,courier,monospace;">http://api.mycompany.com:80/</span>.</p>
<h3>Edge port requirements</h3>
<p>The need to manage the firewall goes beyond just the virtual hosts; both VM and physical host firewalls must allow traffic for the ports required by the components to communicate with each other.&nbsp;</p>
<p>The following image shows the ports requirements for each Edge component:</p>
<p><img alt="" src="../html/sites/docs/files/arch_ports_v11.png" style="width: 731px; height: 540px; border-width: 1px; border-style: solid; margin: 15px;" /></p>
<p><strong>Notes on this diagram:</strong></p>
<ul>
	<li>
		<div>*Port 8082 on the Message Processor only has to be open for access by the Router when you configure TLS/SSL between the Router and Message Processor. If you do not configure TLS/SSL between the Router and Message Processor, the default configuration, port 8082 still must be open on the Message Processor to manage the component, but the Router does not require access to it.</div>
	</li>
	<li>The ports prefixed by "M" are ports used to manage the component and must be open on the component and must be open on the component for access by the Management Server.</li>
	<li>The following components require access to port 8080 on the Management Server: Router, Message Processor, UI, Postgres, and Qpid.</li>
	<li>A Message Processor must open port 4528 as its management port. If you have multiple Message Processors, they must all be able to access each other over port 4528 (indicated by the loop arrow in the diagram above for port 4528 on the Message Processor). If you have multiple Data Centers, the port must be accessible from all Message Processors in all Data Centers.</li>
	<li>While it is not required, you can open port 4527 on the Router for access by any Message Processor. Otherwise, you might see error messages in the Message Processor log files.</li>
	<li>A Router must open port 4527 as its management port. If you have multiple Routers, they must all be able to access each other over port 4527 (indicated by the loop arrow in the diagram above for port 4527 on the Router).</li>
	<li>The Edge UI requires access to the Router, on the ports exposed by API proxies, to support the&nbsp;<strong>Send</strong>&nbsp;button in the trace tool.</li>
	<li>The Management Server requires access to the&nbsp;JMX&nbsp;port on the Cassandra nodes.</li>
	<li>Access to JMX ports can be configured to require a username/password. See <a href="http://docs.apigee.com/node/20686">http://docs.apigee.com/node/20686</a> for more information.&nbsp;</li>
	<li>You can optionally configure TLS/SSL access for certain connections, which can use different ports. See <a href="http://docs.apigee.com/node/18056">http://docs.apigee.com/node/18056</a> for more.</li>
	<li>If configuring two Postgres nodes to use master-standby replication, you must open port 22 on each node for ssh access.&nbsp;You can optionally open ports on individual nodes to allow ssh access.</li>
	<li>You can configure the Management Server and Edge UI to send emails through an external SMTP server. If you do, you must ensure that the Management Server and UI can access the necessary port on the SMTP server. For non-TLS SMTP, the port number is typically 25. For TLS-enabled SMTP, it is often 465, but check with your SMTP provider.&nbsp;</li>
</ul>
<p>The table below shows the ports need to be opened in firewalls, by Edge component:</p>
<table class="table">
	<thead>
		<tr>
			<th>
				<p><strong>Component</strong></p>
			</th>
			<th>
				<p><strong>Port</strong></p>
			</th>
			<th>
				<p><strong>Description</strong></p>
			</th>
		</tr>
	</thead>
	<tbody>
		<tr>
			<td>
				<p><strong>Standard HTTP ports</strong></p>
			</td>
			<td>
				<p>80, 443</p>
			</td>
			<td>
				<p>HTTP plus any other ports you use for virtual hosts</p>
			</td>
		</tr>
		<tr>
			<td rowspan="3">
				<p><strong>Management Server</strong></p>
			</td>
			<td>
				<p>8080</p>
			</td>
			<td>
				<p>Port for Edge management API calls. These components require access to port 8080 on the Management Server: Router, Message Processor, UI, Postgres, and Qpid.</p>
			</td>
		</tr>
		<tr>
			<td>
				<p>1099</p>
			</td>
			<td>
				<p>JMX port</p>
			</td>
		</tr>
		<tr>
			<td>
				<p>4526</p>
			</td>
			<td>
				<p>For distributed cache and management calls</p>
			</td>
		</tr>
		<tr>
			<td>
				<p><strong>Management UI</strong></p>
			</td>
			<td>
				<p>9000</p>
			</td>
			<td>
				<p>Port for browser access to management UI</p>
			</td>
		</tr>
		<tr>
			<td rowspan="4">
				<p><strong>Message Processor</strong></p>
			</td>
			<td>
				<p>8998</p>
			</td>
			<td>
				<p>Message Processor port for communications from Router</p>
			</td>
		</tr>
		<tr>
			<td>
				<p>8082</p>
			</td>
			<td>
				<p>Default management port for Message Processor and must be open on the component for access by the Management Server.</p>
				<div>If you configure TLS/SSL between the Router and Message Processor, used by the Router to make health checks on the Message Processor.</div>
			</td>
		</tr>
		<tr>
			<td>
				<p>1101</p>
			</td>
			<td>
				<p>JMX port</p>
			</td>
		</tr>
		<tr>
			<td>
				<p>4528</p>
			</td>
			<td>
				<p>For distributed cache and management calls&nbsp;between Message Processors, and for communication from the Router</p>
			</td>
		</tr>
		<tr>
			<td rowspan="4">
				<p><strong>Router</strong></p>
			</td>
			<td>
				<p>8081</p>
			</td>
			<td>
				<p>Default management port for Router&nbsp;and must be open on the component for access by the Management Server.</p>
			</td>
		</tr>
		<tr>
			<td>
				<p>4527</p>
			</td>
			<td>
				<p>For distributed cache and management calls</p>
			</td>
		</tr>
		<tr>
			<td>
				<p>15999</p>
			</td>
			<td>
				<p>Health check port. A load balancer uses this port to determine if the Router is available.&nbsp;</p>
				<p>To get the status of a Router, the load balancer makes a request to port 15999 on the Router:</p>
				<pre>
&gt; curl -v http://&lt;routerIP&gt;:15999/v1/servers/self/reachable</pre>
				<p>If the Router is reachable, the request returns HTTP 200.</p>
			</td>
		</tr>
		<tr>
			<td>
				<p>59001</p>
			</td>
			<td>
				<p>Port used for testing the Edge installation by the&nbsp;<span style="font-family:courier new,courier,monospace;">apigee-validate</span>&nbsp;utility. This&nbsp;utility requires access to port&nbsp;59001 on the Router. See&nbsp;<a href="http://docs.apigee.com/node/19906">http://docs.apigee.com/node/19906</a>&nbsp;for more on port 59001.</p>
			</td>
		</tr>
		<tr>
			<td rowspan="2">
				<p><strong>ZooKeeper </strong></p>
			</td>
			<td>
				<p>2181</p>
			</td>
			<td>
				<p>Used by other components like Management Server, Router, Message Processor and so on</p>
			</td>
		</tr>
		<tr>
			<td>
				<p>2888, 3888</p>
			</td>
			<td>
				<p>Used internally by ZooKeeper for ZooKeeper cluster (known as ZooKeeper ensemble) communication</p>
			</td>
		</tr>
		<tr>
			<td rowspan="2">
				<p><strong>Cassandra </strong></p>
			</td>
			<td>
				<p>7000, 9042, 9160</p>
			</td>
			<td>
				<p>Apache Cassandra ports for communication between Cassandra nodes and for access by other Edge components.</p>
			</td>
		</tr>
		<tr>
			<td>
				<p>7199</p>
			</td>
			<td>
				<p>JMX port. Must be open for access by the Management Server.</p>
			</td>
		</tr>
		<tr>
			<td rowspan="4">
				<p><strong>Qpid </strong></p>
			</td>
			<td>
				<p>5672</p>
			</td>
			<td>
				<p>Used for communications from the Router and Message Processor to Qpid server</p>
			</td>
		</tr>
		<tr>
			<td>
				<p>8083</p>
			</td>
			<td>
				<p>Default management port on Qpid server&nbsp;and must be open on the component for access by the Management Server.</p>
			</td>
		</tr>
		<tr>
			<td>
				<p>1102</p>
			</td>
			<td>
				<p>JMX port</p>
			</td>
		</tr>
		<tr>
			<td>
				<p>4529</p>
			</td>
			<td>
				<p>For distributed cache and management calls</p>
			</td>
		</tr>
		<tr>
			<td rowspan="5">
				<p><strong>Postgres </strong></p>
			</td>
			<td>
				<p>5432</p>
			</td>
			<td>
				<p>Used for communication from Qpid/Management Server to Postgres</p>
			</td>
		</tr>
		<tr>
			<td>
				<p>8084</p>
			</td>
			<td>
				<p>Default management port on Postgres serverand must be open on the component for access by the Management Server.</p>
			</td>
		</tr>
		<tr>
			<td>
				<p>1103</p>
			</td>
			<td>
				<p>JMX port</p>
			</td>
		</tr>
		<tr>
			<td>
				<p>4530</p>
			</td>
			<td>
				<p>For distributed cache and management calls</p>
			</td>
		</tr>
		<tr>
			<td>
				<p>22</p>
			</td>
			<td>
				<p>If configuring two Postgres nodes to use master-standby replication, you must open port 22 on each node for ssh access.&nbsp;</p>
			</td>
		</tr>
		<tr>
			<td style="height:27px;">
				<p><strong>LDAP </strong></p>
			</td>
			<td style="height:27px;">
				<p>10389</p>
			</td>
			<td style="height:27px;">
				<p>OpenLDAP</p>
			</td>
		</tr>
		<tr>
			<td style="height:27px;">
				<p><strong>SmartDocs</strong></p>
			</td>
			<td style="height:27px;">
				<p>59002</p>
			</td>
			<td style="height:27px;">
				<p>The port on the Edge router where SmartDocs page requests are sent.</p>
			</td>
		</tr>
	</tbody>
</table>
<p>The next table shows the same ports, listed numerically, with the source and destination components:</p>
<table class="table">
	<thead>
		<tr>
			<th>
				<p><strong>Port Number</strong></p>
			</th>
			<th>
				<p><strong>Purpose&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </strong></p>
			</th>
			<th>
				<p><strong>Source Component</strong></p>
			</th>
			<th>
				<p><strong>Destination Component</strong></p>
			</th>
		</tr>
	</thead>
	<tbody>
		<tr>
			<td>
				<p><strong>&lt;virtual host port#&gt;</strong></p>
			</td>
			<td>
				<p>HTTP plus any other ports you use for virtual host API call traffic. Ports 80 and 443 are most commonly used; the Message Router can terminate TLS/SSL connections.</p>
			</td>
			<td>
				<p>External client (or load balancer)</p>
			</td>
			<td>
				<p>Listener on Message Router</p>
			</td>
		</tr>
		<tr>
			<td>
				<p><strong>1099 through 1103</strong></p>
			</td>
			<td>
				<p>JMX Management</p>
			</td>
			<td>
				<p>JMX Client</p>
			</td>
			<td>
				<p>Management Server (1099)</p>
				<p>Message Processor (1101)</p>
				<p>Qpid Server (1102)</p>
				<p>Postgres Server (1103)</p>
			</td>
		</tr>
		<tr>
			<td>
				<p><strong>2181</strong></p>
			</td>
			<td>
				<p>Zookeeper client communication</p>
			</td>
			<td>
				<p>Management Server</p>
				<p>Router</p>
				<p>Message Processor</p>
				<p>Qpid Server</p>
				<p>Postgres Server</p>
			</td>
			<td>
				<p>Zookeeper</p>
			</td>
		</tr>
		<tr>
			<td>
				<p><strong>2888 and 3888</strong></p>
			</td>
			<td>
				<p>Zookeeper internode management</p>
			</td>
			<td>
				<p>Zookeeper</p>
			</td>
			<td>
				<p>Zookeeper</p>
			</td>
		</tr>
		<tr>
			<td>
				<p><strong>4526 through 4530</strong></p>
			</td>
			<td>
				<p>RPC Management ports used for distributed cache and calls from the Management Servers to the other components</p>
			</td>
			<td>
				<p>Management Server</p>
			</td>
			<td>
				<p>Management Server (4526)</p>
				<p>Router (4527)</p>
				<p>Message Processor (4528)</p>
				<p>Qpid Server (4529)</p>
				<p>Postgres Server (4530)</p>
			</td>
		</tr>
		<tr>
			<td>
				<p><strong>4528</strong></p>
			</td>
			<td>
				<p>For distributed cache calls&nbsp;between Message Processors, and for communication from the Router</p>
			</td>
			<td>
				<p>Router</p>
				<p>Message Processor</p>
			</td>
			<td>
				<p>Message Processor</p>
			</td>
		</tr>
		<tr>
			<td>
				<p><strong>5432</strong></p>
			</td>
			<td>
				<p>Postgres client</p>
			</td>
			<td>
				<p>Qpid Server</p>
			</td>
			<td>
				<p>Postgres</p>
			</td>
		</tr>
		<tr>
			<td>
				<p><strong>5672</strong></p>
			</td>
			<td>
				<p>Used for sending analytics from Router and Message Processor to Qpid</p>
			</td>
			<td>
				<p>Router</p>
				<p>Message Processor</p>
			</td>
			<td>
				<p>Qpid Server</p>
			</td>
		</tr>
		<tr>
			<td>
				<p><strong>7000</strong></p>
			</td>
			<td>
				<p>Cassandra inter-node communications</p>
			</td>
			<td>
				<p>Cassandra</p>
			</td>
			<td>
				<p>Other Cassandra node</p>
			</td>
		</tr>
		<tr>
			<td>
				<p><strong>7199</strong></p>
			</td>
			<td>
				<p>JMX management.&nbsp;Must be open for access on the Cassandra node by the Management Server.</p>
			</td>
			<td>
				<p>JMX client</p>
			</td>
			<td>
				<p>Cassandra</p>
			</td>
		</tr>
		<tr>
			<td>
				<p><strong>8080</strong></p>
			</td>
			<td>
				<p>Management API port</p>
			</td>
			<td>
				<p>Management API clients</p>
			</td>
			<td>
				<p>Management Server</p>
			</td>
		</tr>
		<tr>
			<td>
				<p><strong>8081 through 8084</strong></p>
			</td>
			<td>
				<p>Component API ports, used for issuing API requests directly to individual components. Each component opens a different port; the exact port used depends on the configuration but must be open on the component for access by the Management Server</p>
			</td>
			<td>
				<p>Management API clients</p>
			</td>
			<td>
				<p>Router (8081)</p>
				<p>Message Processor (8082)</p>
				<p>Qpid Server (8083)</p>
				<p>Postgres Server (8084)</p>
			</td>
		</tr>
		<tr>
			<td>
				<p><strong>8998</strong></p>
			</td>
			<td>
				<p>Communication between Router and Message Processor</p>
			</td>
			<td>
				<p>Router</p>
			</td>
			<td>
				<p>Message Processor</p>
			</td>
		</tr>
		<tr>
			<td>
				<p><strong>9000</strong></p>
			</td>
			<td>
				<p>Default Edge management UI port</p>
			</td>
			<td>
				<p>Browser</p>
			</td>
			<td>
				<p>Management UI Server</p>
			</td>
		</tr>
		<tr>
			<td>
				<p><strong>9042</strong></p>
			</td>
			<td>
				<p>CQL native transport</p>
			</td>
			<td>
				<p>Router</p>
				<p>Message Processor</p>
				<p>Management Server</p>
			</td>
			<td>
				<p>Cassandra</p>
			</td>
		</tr>
		<tr>
			<td>
				<p><strong>9160</strong></p>
			</td>
			<td>
				<p>Cassandra thrift client</p>
			</td>
			<td>
				<p>Router</p>
				<p>Message Processor</p>
				<p>Management Server</p>
			</td>
			<td>
				<p>Cassandra</p>
			</td>
		</tr>
		<tr>
			<td>
				<p><strong>10389</strong></p>
			</td>
			<td>
				<p>LDAP port</p>
			</td>
			<td>
				<p>Management Server</p>
			</td>
			<td>
				<p>OpenLDAP</p>
			</td>
		</tr>
		<tr>
			<td><strong>15999</strong></td>
			<td>
				<p>Health check port. A load balancer uses this port to determine if the Router is available.&nbsp;</p>
			</td>
			<td>Load balancer</td>
			<td>Router</td>
		</tr>
		<tr>
			<td><strong>59001</strong></td>
			<td>Port used by the <span style="font-family:courier new,courier,monospace;">apigee-validate</span>&nbsp;utility to test the Edge installation</td>
			<td>apigee-validate</td>
			<td>Router</td>
		</tr>
		<tr>
			<td>
				<p><strong>59002</strong></p>
			</td>
			<td>
				<p>The router port where SmartDocs page requests are sent</p>
			</td>
			<td>
				<p>SmartDocs</p>
			</td>
			<td>
				<p>Router</p>
			</td>
		</tr>
	</tbody>
</table>
<p>A message processor keeps a dedicated connection pool open to Cassandra, which is configured to never timeout. When a firewall is between a message processor and Cassandra server, the firewall can time out the connection. However, the message processor is not designed to reestablish connections to Cassandra.</p>
<p>To prevent this situation, Apigee recommends that the Cassandra server, message processor, and routers be in the same subnet so that a firewall is not involved in the deployment of these components.</p>
<p>If a firewall is between the router and message processors, and has an idle tcp timeout set, our recommendations is to:</p>
<ol>
	<li>Set <span style="font-family:courier new,courier,monospace;">net.ipv4.tcp_keepalive_time = 1800</span> in sysctl settings on Linux OS, where 1800 should be lower than the firewall idle tcp timeout. This setting should keep the connection in an established state so that the firewall does not disconnect the connection.</li>
	<li>On all Message Processors, edit <span style="font-family:courier new,courier,monospace;">/&lt;inst_root&gt;/apigee/customer/application/message-processor.properties</span> to add the following property. If the file does not exist, create it.<br />
		<span style="font-family:courier new,courier,monospace;">conf_system_casssandra.maxconnecttimeinmillis=-1</span></li>
	<li>Restart the Message Processor:<br />
		<span style="font-family:courier new,courier,monospace;">&gt; /opt/apigee/apigee-service/bin/apigee-service edge-message-processor restart</span></li>
	<li>On all Routers, edit <span style="font-family:courier new,courier,monospace;">/&lt;inst_root&gt;/apigee/customer/application/router.properties</span> to add the following property. If the file does not exist, create it.<br />
		<span style="font-family:courier new,courier,monospace;">conf_system_casssandra.maxconnecttimeinmillis=-1</span></li>
	<li>Restart the Router:<br />
		<span style="font-family:courier new,courier,monospace;">&gt; /opt/apigee/apigee-service/bin/apigee-service edge-router restart</span></li>
</ol>
<p>If you install the 12 host clustered configuration with two Data Centers, ensure that the nodes in the two Data Centers can communicate over the ports shown below:</p>
<p><img alt="" src="../html/sites/docs/files/arch_ports_multi_dc_V7.png" style="width: 705px; height: 497px; border-width: 1px; border-style: solid; margin: 15px;" /></p>
<div class="note">
	<ul>
		<li>All Management Servers must be able to access all Cassandra nodes in all other Data Centers.</li>
		<li>All Message Processors in all Data Centers must all be able to access each other over port 4528.</li>
		<li>The Management Server must be able to access all Message Processors over port 8082.</li>
		<li>All Management Servers and all Qpid nodes must be able to access Postgres in all other Data Centers.</li>
		<li><strong>For security reasons</strong>, other than the ports shown above and any others required by your own network requirements, no other ports should be open between data centers.</li>
	</ul>
</div>
<h3>API BaaS port requirements</h3>
<p>If you opt to install the API BaaS, you add the API BaaS Stack and API BaaS Portal components. These components use the ports shown in the figure below:</p>
<p><img alt="" src="../html/sites/docs/files/arch_ports_baas_16_01_large_v6.png" style="width: 704px; height: 478px; border-width: 1px; border-style: solid; margin: 15px;" /></p>
<p><strong>Notes on this diagram:</strong></p>
<ul>
	<li>The API BaaS Portal never makes requests directly to an BaaS Stack node. When a developer logs into the Portal, the Portal app is downloaded to the browser. The Portal app running in the browser then makes requests to the BaaS Stack nodes.</li>
	<li>A production installation of API BaaS uses a load balancer between the API BaaS Portal node and API BaaS Stack nodes. When configuring the Portal, and when making BaaS API calls, you specify the IP address or DNS name of the load balancer, not of the Stack nodes.&nbsp;</li>
	<li>All Stack nodes must open port 2551 for access from all other Stack nodes (indicated by the loop arrow in the diagram above for port 2551 on the Stack nodes). If you have multiple Data Centers, the port must be accessible from all Stack nodes in all Data Centers.</li>
	<li>You must configure all Baas Stack nodes to send emails through an external SMTP server. For non-TLS SMTP, the port number is typically 25. For TLS-enabled SMTP, it is often 465, but check with your SMTP provider.&nbsp;</li>
	<li>The Cassandra nodes can be dedicated to API BaaS, or can be shared with Edge.</li>
</ul>
<p>The table below shows the default ports that need to be opened in firewalls, by component:</p>
<table class="table">
	<thead>
		<tr>
			<th>
				<p><strong>Component</strong></p>
			</th>
			<th>
				<p><strong>Port</strong></p>
			</th>
			<th>
				<p><strong>Description</strong></p>
			</th>
		</tr>
	</thead>
	<tbody>
		<tr>
			<td>
				<p><strong>API BaaS Portal</strong></p>
			</td>
			<td>
				<p>9000</p>
			</td>
			<td>
				<p>Port for the API BaaS UI</p>
			</td>
		</tr>
		<tr>
			<td>
				<p><strong>API BaaS Stack</strong></p>
			</td>
			<td>
				<p>8080</p>
			</td>
			<td>
				<p>Port where API request are received</p>
			</td>
		</tr>
		<tr>
			<td>&nbsp;</td>
			<td>2551</td>
			<td>
				<p>Port for communication among all Stack nodes. Must be accessible by all other Stack nodes in the data canter.</p>
				<p>If you have multiple data centers, the port must be accessible from all Stack nodes in all Data Centers.&nbsp;</p>
			</td>
		</tr>
		<tr>
			<td>
				<p><strong>ElasticSearch</strong></p>
			</td>
			<td>
				<p>9200 to 9400</p>
			</td>
			<td>
				<p>For communicating with API BaaS Stack and for communicating between ElasticSearch nodes</p>
			</td>
		</tr>
	</tbody>
</table>
<h2>Licensing</h2>
<p>Each installation of Edge requires a unique license file that you obtain from Apigee. You will need to provide the path to the license file when installing the management server, for example /tmp/license.txt.&nbsp;</p>
<p>The installer copies the license file to <span style="font-family:courier new,courier,monospace;">/&lt;inst_root&gt;/apigee/customer/conf/license.txt</span>.&nbsp;</p>
<p>If license file is valid, the management server validates the expiry and allowed Message Processor (MP) count. If any of the license settings is expired, you can find the logs in the following location: <span style="font-family:courier new,courier,monospace;">/&lt;inst_root&gt;/apigee/var/log/edge-management-server/logs</span>. In this case you can contact <a href="http://support@apigee.com">Apigee Support</a> for migration details.&nbsp;</p>
