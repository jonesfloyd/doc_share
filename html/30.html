<h1> XML Threat Protection policy </h1>
<img src="sites/docs/files/icon_policy_threat-protection.jpg" />
<h3>What</h3>
<p>Address XML vulnerabilities and minimize attacks on your API. Optionally, detect XML payload attacks based on configured limits. Screen against XML threats using the following approaches:</p>
<ul>
	<li>Validate messages against an XML schema (<code>.xsd</code>)</li>
	<li>Evaluate message content for specific blacklisted keywords or patterns</li>
	<li>Detect corrupt or malformed messages before those messages are parsed</li>
</ul>
<h3>Where</h3>
<p>This policy can be attached in the following locations.</p>
<table cellspacing="0" style="margin:20px 20px 20px 0px" width="650">
	<tbody>
		<tr bgcolor="#e5e5e5" style="font-size:13px; line-height:20px" valign="middle">
			<td class="bbdbrd" colspan="5" style="text-align: center">ProxyEndpoint</td>
			<td class="bbd" colspan="5" style="text-align: center">TargetEndpoint</td>
		</tr>
		<tr bgcolor="#f4f4f4" style="font-size:12px; line-height:20px" valign="middle">
			<td>&nbsp;</td>
			<td>&nbsp;</td>
			<td style="text-align: center">PreFlow</td>
			<td style="text-align: center">Flow</td>
			<td class="brl" style="text-align: center">PostFlow</td>
			<td style="text-align: center">PreFlow</td>
			<td style="text-align: center">Flow</td>
			<td style="text-align: center">PostFlow</td>
			<td>&nbsp;</td>
			<td>&nbsp;</td>
		</tr>
		<tr style="font-size:36px; line-height:24px" valign="middle">
			<td class="bbl" style="text-align: right; font-size:13px; font-style:italic">Request</td>
			<td class="bbl" style="text-align:center; font-size:16px">→</td>
			<!-- Start request dots. Option+8 for dot. Third dot is bblbrl class. -->
			<td class="bbl" style="text-align: center; color: #7DD31F">•</td>
			<td class="bbl" style="text-align: center; color: #7DD31F">•</td>
			<td class="bblbrl" style="text-align: center; color: #7DD31F">•</td>
			<td class="bbl" style="text-align: center; color: #7DD31F">•</td>
			<td class="bbl" style="text-align: center; color: #7DD31F">•</td>
			<td class="bbl" style="text-align: center; color: #7DD31F">•</td>
			<!-- End request dots -->
			<td class="bbl">&nbsp;</td>
			<td class="bbl">&nbsp;</td>
		</tr>
		<tr style="font-size:36px; line-height:24px" valign="middle">
			<td>&nbsp;</td>
			<td>&nbsp;</td>
			<!-- Start response dots. Option+8 for dot. Third dot is brl class. -->
			<td style="text-align: center; color: #7DD31F">•</td>
			<td style="text-align: center; color: #7DD31F">•</td>
			<td class="brl" style="text-align: center; color: #7DD31F">•</td>
			<td style="text-align: center; color: #7DD31F;">•</td>
			<td style="text-align: center; color: #7DD31F;">•</td>
			<td style="text-align: center; color: #7DD31F;">•</td>
			<!-- End response dots -->
			<td style="text-align:center; font-size:16px">←</td>
			<td style="text-align: left; font-size:13px; font-style:italic">Response</td>
		</tr>
		<tr bgcolor="#f4f4f4" style="font-size:12px; line-height:20px" valign="middle">
			<td>&nbsp;</td>
			<td>&nbsp;</td>
			<td style="text-align: center">PostFlow</td>
			<td style="text-align: center">Flow</td>
			<td class="brl" style="text-align: center">PreFlow</td>
			<td style="text-align: center">PostFlow</td>
			<td style="text-align: center">Flow</td>
			<td style="text-align: center">PreFlow</td>
			<td>&nbsp;</td>
			<td>&nbsp;</td>
		</tr>
	</tbody>
</table>
<h2>Watch a short video on threat protection&nbsp;</h2>
<div class="video">
	<p><strong>Video:</strong> Watch a short video on threat protection policies from the Four-minute Videos for Developers (4MV4D) series.</p>
	<div class="collapse" id="demo1">
		<div style="text-align: left; margin:15px"><iframe allowfullscreen="" frameborder="0" height="480" src="https://www.youtube.com/embed/rC8kZJgwBFM?list=PLIXjuPlujxxxe3iTmLtgfIBgpMo7iD7fk" width="854"></iframe></div>
	</div>
	<div id="collapsible_1"><a class="btn" data-toggle="collapse" href="#demo1">Show/Hide Video</a></div>
</div>
<h2 id="elementreference">Element reference</h2>
<p>The element reference describes the elements and attributes of the XMLThreatProtection policy.</p>
<pre>
&lt;XMLThreatProtection async="false" continueOnError="false" enabled="true" name="XML-Threat-Protection-1"&gt;
   &lt;DisplayName&gt;XML Threat Protection 1&lt;/DisplayName&gt;
   &lt;NameLimits&gt;
      &lt;Element&gt;10&lt;/Element&gt;
      &lt;Attribute&gt;10&lt;/Attribute&gt;
      &lt;NamespacePrefix&gt;10&lt;/NamespacePrefix&gt;
      &lt;ProcessingInstructionTarget&gt;10&lt;/ProcessingInstructionTarget&gt;
   &lt;/NameLimits&gt;
   &lt;Source&gt;request&lt;/Source&gt;
   &lt;StructureLimits&gt;
      &lt;NodeDepth&gt;5&lt;/NodeDepth&gt;
      &lt;AttributeCountPerElement&gt;2&lt;/AttributeCountPerElement&gt;
      &lt;NamespaceCountPerElement&gt;3&lt;/NamespaceCountPerElement&gt;
      &lt;ChildCount includeComment="true" includeElement="true" includeProcessingInstruction="true" includeText="true"&gt;3&lt;/ChildCount&gt;
   &lt;/StructureLimits&gt;
   &lt;ValueLimits&gt;
      &lt;Text&gt;15&lt;/Text&gt;
      &lt;Attribute&gt;10&lt;/Attribute&gt;
      &lt;NamespaceURI&gt;10&lt;/NamespaceURI&gt;
      &lt;Comment&gt;10&lt;/Comment&gt;
      &lt;ProcessingInstructionData&gt;10&lt;/ProcessingInstructionData&gt;
   &lt;/ValueLimits&gt; 
&lt;/XMLThreatProtection&gt;</pre>
<h2>&lt;XMLThreatProtection&gt; attributes</h2>
<pre>
&lt;XMLThreatProtection async="false" continueOnError="false" enabled="true" name="XML-Threat-Protection-1"&gt; </pre>
<a href="http://docs.apigee.com/node/18471">Content to be inserted here</a>
<h2>&lt;NameLimits&gt; element</h2>
<p>Specifies character limits to be checked and enforced by the policy.</p>
<pre>
&lt;NameLimits&gt;
   &lt;Element&gt;10&lt;/Element&gt;
   &lt;Attribute&gt;10&lt;/Attribute&gt;
   &lt;NamespacePrefix&gt;10&lt;/NamespacePrefix&gt;
   &lt;ProcessingInstructionTarget&gt;10&lt;/ProcessingInstructionTarget&gt;     
&lt;/NameLimits&gt;</pre>
<table class="pd-table">
	<tbody>
		<tr>
			<td class="pd-td-left">Default:</td>
			<td class="pd-td-right">N/A</td>
		</tr>
		<tr>
			<td class="pd-td-left">Presence:</td>
			<td class="pd-td-right">Optional</td>
		</tr>
		<tr>
			<td class="pd-td-left">Type:</td>
			<td class="pd-td-right">N/A</td>
		</tr>
	</tbody>
</table>
<h2>&lt;NameLimits&gt;/&lt;Element&gt; element</h2>
<p>Specifies a limit on the maximum number of characters permitted in any element name in the XML document.</p>
<p>For example, consider the following XML:</p>
<pre>
&lt;book category="WEB"&gt;
   &lt;title&gt;Learning XML&lt;/title&gt;
   &lt;author&gt;Erik T. Ray&lt;/author&gt;
   &lt;year&gt;2003&lt;/year&gt;
&lt;/book&gt;</pre>
<p>When analyzing the XML above, the <code>&lt;Element&gt;</code> element value in the policy snippet below will validate that element names (<code>book</code> , <code>title</code>, <code>author</code>, and <code>year)</code> do not exceed <code>10</code> characters.</p>
<pre>
&lt;NameLimits&gt;
   &lt;Element&gt;10&lt;/Element&gt;
   &lt;Attribute&gt;10&lt;/Attribute&gt;
   &lt;NamespacePrefix&gt;10&lt;/NamespacePrefix&gt;
   &lt;ProcessingInstructionTarget&gt;10&lt;/ProcessingInstructionTarget&gt;     
&lt;/NameLimits&gt;</pre>
<table class="pd-table">
	<tbody>
		<tr>
			<td class="pd-td-left">Default:</td>
			<td class="pd-td-right">If you do not specify a limit, the system applies a default value of <code>-1</code>, which the system equates to no limit.</td>
		</tr>
		<tr>
			<td class="pd-td-left">Presence:</td>
			<td class="pd-td-right">Optional</td>
		</tr>
		<tr>
			<td class="pd-td-left">Type:</td>
			<td class="pd-td-right">Integer</td>
		</tr>
	</tbody>
</table>
<h2>&lt;NameLimits&gt;/&lt;Attribute&gt; element</h2>
<p>Specifies a limit on the maximum number of characters permitted in any attribute name in the XML document.</p>
<p>For example, consider the following XML:</p>
<pre>
&lt;book category="WEB"&gt;
   &lt;title&gt;Learning XML&lt;/title&gt;
   &lt;author&gt;Erik T. Ray&lt;/author&gt;
   &lt;year&gt;2003&lt;/year&gt;
&lt;/book&gt;</pre>
<p>When analyzing the XML above, the <code>&lt;Attribute&gt;</code> element value in the policy snippet below will validate that attribute name <code>category</code> does not exceed <code>10</code> characters.</p>
<pre>
&lt;NameLimits&gt;
   &lt;Element&gt;10&lt;/Element&gt;
   &lt;Attribute&gt;10&lt;/Attribute&gt;
   &lt;NamespacePrefix&gt;10&lt;/NamespacePrefix&gt;
   &lt;ProcessingInstructionTarget&gt;10&lt;/ProcessingInstructionTarget&gt;     
&lt;/NameLimits&gt;</pre>
<table class="pd-table">
	<tbody>
		<tr>
			<td class="pd-td-left">Default:</td>
			<td class="pd-td-right">If you do not specify a limit, the system applies a default value of <code>-1</code>, which the system equates to no limit.</td>
		</tr>
		<tr>
			<td class="pd-td-left">Presence:</td>
			<td class="pd-td-right">Optional</td>
		</tr>
		<tr>
			<td class="pd-td-left">Type:</td>
			<td class="pd-td-right">Integer</td>
		</tr>
	</tbody>
</table>
<h2>&lt;NameLimits&gt;/&lt;NamespacePrefix&gt; element</h2>
<p>Specifies a limit on the maximum number of characters permitted in the namespace prefix in the XML document.</p>
<p>For example, consider the following XML:</p>
<pre>
&lt;ns1:myelem xmlns:ns1="http://ns1.com"/&gt;</pre>
<p>When analyzing the XML above, the <code>&lt;NamespacePrefix&gt;</code> element value in the policy snippet below will validate that the namespace prefix <code>ns1</code> does not exceed <code>10</code> characters.</p>
<pre>
&lt;NameLimits&gt;
   &lt;Element&gt;10&lt;/Element&gt;
   &lt;Attribute&gt;10&lt;/Attribute&gt;
   &lt;NamespacePrefix&gt;10&lt;/NamespacePrefix&gt;
   &lt;ProcessingInstructionTarget&gt;10&lt;/ProcessingInstructionTarget&gt;     
&lt;/NameLimits&gt;</pre>
<table class="pd-table">
	<tbody>
		<tr>
			<td class="pd-td-left">Default:</td>
			<td class="pd-td-right">If you do not specify a limit, the system applies a default value of <code>-1</code>, which the system equates to no limit.</td>
		</tr>
		<tr>
			<td class="pd-td-left">Presence:</td>
			<td class="pd-td-right">Optional</td>
		</tr>
		<tr>
			<td class="pd-td-left">Type:</td>
			<td class="pd-td-right">Integer</td>
		</tr>
	</tbody>
</table>
<h2>&lt;NameLimits&gt;/&lt;ProcessingInstructionTarget&gt; element</h2>
<p>Specifies a limit on the maximum number of characters permitted in the target of any processing instructions in the XML document.</p>
<p>For example, consider the following XML:</p>
<pre>
&lt;?xml-stylesheet type="text/xsl" href="style.xsl"?&gt;</pre>
<p>When analyzing the XML above, the <code>&lt;ProcessingInstructionTarget&gt;</code> element value in the policy snippet below will validate that the processing instruction target <code>xml-stylesheet</code> does not exceed <code>10</code> characters.</p>
<pre>
&lt;NameLimits&gt;
   &lt;Element&gt;10&lt;/Element&gt;
   &lt;Attribute&gt;10&lt;/Attribute&gt;
   &lt;NamespacePrefix&gt;10&lt;/NamespacePrefix&gt;
   &lt;ProcessingInstructionTarget&gt;10&lt;/ProcessingInstructionTarget&gt;     
&lt;/NameLimits&gt;</pre>
<table class="pd-table">
	<tbody>
		<tr>
			<td class="pd-td-left">Default:</td>
			<td class="pd-td-right">If you do not specify a limit, the system applies a default value of <code>-1</code>, which the system equates to no limit.</td>
		</tr>
		<tr>
			<td class="pd-td-left">Presence:</td>
			<td class="pd-td-right">Optional</td>
		</tr>
		<tr>
			<td class="pd-td-left">Type:</td>
			<td class="pd-td-right">Integer</td>
		</tr>
	</tbody>
</table>
<h2>&lt;Source&gt; element</h2>
<p>Message to be screened for XML payload attacks. This is most commonly set to <code>request</code>, as you will typically need to validate inbound requests from client apps. When set to <code>message</code>, this element will automatically evaluate the request message when attached to the request flow and the response message when attached to the response flow.</p>
<pre>
&lt;Source&gt;request&lt;/Source&gt;</pre>
<table class="pd-table">
	<tbody>
		<tr>
			<td class="pd-td-left">Default:</td>
			<td class="pd-td-right">request</td>
		</tr>
		<tr>
			<td class="pd-td-left">Presence:</td>
			<td class="pd-td-right">Optional</td>
		</tr>
		<tr>
			<td class="pd-td-left">Type:</td>
			<td class="pd-td-right">
				<p>String.</p>
				<p>Select from <code>request</code>, <code>response</code>, or <code>message</code>.</p>
			</td>
		</tr>
	</tbody>
</table>
<h2>&lt;StructuralLimits&gt; element</h2>
<p>Specifies structural limits to be checked and enforced by the policy.</p>
<pre>
&lt;StructureLimits&gt;
   &lt;NodeDepth&gt;5&lt;/NodeDepth&gt;
   &lt;AttributeCountPerElement&gt;2&lt;/AttributeCountPerElement&gt;
   &lt;NamespaceCountPerElement&gt;3&lt;/NamespaceCountPerElement&gt;
   &lt;ChildCount includeComment="true" includeElement="true" includeProcessingInstruction="true" includeText="true"&gt;3&lt;/ChildCount&gt;
&lt;/StructureLimits&gt;</pre>
<table class="pd-table">
	<tbody>
		<tr>
			<td class="pd-td-left">Default:</td>
			<td class="pd-td-right">N/A</td>
		</tr>
		<tr>
			<td class="pd-td-left">Presence:</td>
			<td class="pd-td-right">Optional</td>
		</tr>
		<tr>
			<td class="pd-td-left">Type:</td>
			<td class="pd-td-right">N/A</td>
		</tr>
	</tbody>
</table>
<h2>&lt;StructuralLimits&gt;/&lt;NodeDepth&gt; element</h2>
<p>Specifies the maximum node depth allowed in the XML.</p>
<pre>
&lt;StructureLimits&gt;
   &lt;NodeDepth&gt;5&lt;/NodeDepth&gt;
   &lt;AttributeCountPerElement&gt;2&lt;/AttributeCountPerElement&gt;
   &lt;NamespaceCountPerElement&gt;3&lt;/NamespaceCountPerElement&gt;
   &lt;ChildCount includeComment="true" includeElement="true" includeProcessingInstruction="true" includeText="true"&gt;3&lt;/ChildCount&gt;
&lt;/StructureLimits&gt;</pre>
<table class="pd-table">
	<tbody>
		<tr>
			<td class="pd-td-left">Default:</td>
			<td class="pd-td-right">If you do not specify a limit, the system applies a default value of <code>-1</code>, which the system equates to no limit.</td>
		</tr>
		<tr>
			<td class="pd-td-left">Presence:</td>
			<td class="pd-td-right">Optional</td>
		</tr>
		<tr>
			<td class="pd-td-left">Type:</td>
			<td class="pd-td-right">
				<p>Integer</p>
			</td>
		</tr>
	</tbody>
</table>
<h2>&lt;StructuralLimits&gt;/&lt;AttributeCountPerElement&gt; element</h2>
<p>Specifies the maximum number of attributes allowed for any element.</p>
<p>For example, consider the following XML:</p>
<pre>
&lt;book category="WEB"&gt;
   &lt;title&gt;Learning XML&lt;/title&gt;
   &lt;author&gt;Erik T. Ray&lt;/author&gt;
   &lt;year&gt;2003&lt;/year&gt;
&lt;/book&gt;</pre>
When analyzing the XML above, the <code>&lt;AttributeCountPerElement&gt;</code> element value in the policy snippet below will validate that the elements <code>book</code>, <code>title</code>, <code>author</code>, and <code>year</code> do not have more than <code>2</code> attributes each. Note that attributes used for defining namespaces are not counted.
<pre>
&lt;StructureLimits&gt;
   &lt;NodeDepth&gt;5&lt;/NodeDepth&gt;
   &lt;AttributeCountPerElement&gt;2&lt;/AttributeCountPerElement&gt;
   &lt;NamespaceCountPerElement&gt;3&lt;/NamespaceCountPerElement&gt;
   &lt;ChildCount includeComment="true" includeElement="true" includeProcessingInstruction="true" includeText="true"&gt;3&lt;/ChildCount&gt;
&lt;/StructureLimits&gt;</pre>
<table class="pd-table">
	<tbody>
		<tr>
			<td class="pd-td-left">Default:</td>
			<td class="pd-td-right">If you do not specify a limit, the system applies a default value of <code>-1</code>, which the system equates to no limit.</td>
		</tr>
		<tr>
			<td class="pd-td-left">Presence:</td>
			<td class="pd-td-right">Optional</td>
		</tr>
		<tr>
			<td class="pd-td-left">Type:</td>
			<td class="pd-td-right">
				<p>Integer</p>
			</td>
		</tr>
	</tbody>
</table>
<h2>&lt;StructuralLimits&gt;/&lt;NameSpaceCountPerElement&gt; element</h2>
<p>Specifies the maximum number of namespace definitions allowed for any element.</p>
<p>For example, consider the following XML:</p>
<pre>
&lt;e1 attr1="val1" attr2="val2"&gt;
&nbsp;&nbsp;&nbsp; &lt;e2 xmlns="http://apigee.com" xmlns:yahoo="http://yahoo.com" one="1" yahoo:two="2"/&gt;
&lt;/e1&gt;</pre>
<p>When analyzing the XML above, the <code>&lt;NamespaceCountPerElement&gt;</code> element value in the policy snippet below will validate that the elements <code>e1</code> and <code>e2 </code>do not have more than <code>2</code> namespace definitions each. In this case, <span style="font-family:courier new,courier,monospace;">&lt;e1&gt;</span> has 0 namespace definitions and <span style="font-family:courier new,courier,monospace;">&lt;e2&gt;</span> has 2 namespace definitions: <code>xmlns="http://apigee.com"</code> and <code>xmlns:yahoo="http://yahoo.com"</code>.</p>
<pre>
&lt;StructureLimits&gt;
   &lt;NodeDepth&gt;5&lt;/NodeDepth&gt;
   &lt;AttributeCountPerElement&gt;2&lt;/AttributeCountPerElement&gt;
   &lt;NamespaceCountPerElement&gt;3&lt;/NamespaceCountPerElement&gt;
   &lt;ChildCount includeComment="true" includeElement="true" includeProcessingInstruction="true" includeText="true"&gt;3&lt;/ChildCount&gt;
&lt;/StructureLimits&gt;</pre>
<table class="pd-table">
	<tbody>
		<tr>
			<td class="pd-td-left">Default:</td>
			<td class="pd-td-right">If you do not specify a limit, the system applies a default value of <code>-1</code>, which the system equates to no limit.</td>
		</tr>
		<tr>
			<td class="pd-td-left">Presence:</td>
			<td class="pd-td-right">Optional</td>
		</tr>
		<tr>
			<td class="pd-td-left">Type:</td>
			<td class="pd-td-right">
				<p>Integer</p>
			</td>
		</tr>
	</tbody>
</table>
<h2>&lt;StructuralLimits&gt;/&lt;ChildCount&gt; element</h2>
<p>Specifies the maximum number of child elements allowed for any element.</p>
<pre>
&lt;StructureLimits&gt;
   &lt;NodeDepth&gt;5&lt;/NodeDepth&gt;
   &lt;AttributeCountPerElement&gt;2&lt;/AttributeCountPerElement&gt;
   &lt;NamespaceCountPerElement&gt;3&lt;/NamespaceCountPerElement&gt;
   &lt;ChildCount includeComment="true" includeElement="true" includeProcessingInstruction="true" includeText="true"&gt;3&lt;/ChildCount&gt;
&lt;/StructureLimits&gt;</pre>
<table class="pd-table">
	<tbody>
		<tr>
			<td class="pd-td-left">Default:</td>
			<td class="pd-td-right">If you do not specify a limit, the system applies a default value of <code>-1</code>, which the system equates to no limit.</td>
		</tr>
		<tr>
			<td class="pd-td-left">Presence:</td>
			<td class="pd-td-right">Optional</td>
		</tr>
		<tr>
			<td class="pd-td-left">Type:</td>
			<td class="pd-td-right">
				<p>Integer</p>
			</td>
		</tr>
	</tbody>
</table>
<h3>Attributes</h3>
<table border="1" cellpadding="1" cellspacing="1" class="table" width="650">
	<tbody>
		<tr>
			<th scope="col">Attribute</th>
			<th scope="col">Default</th>
			<th scope="col">Presence</th>
		</tr>
		<tr>
			<td>includeComment</td>
			<td>true</td>
			<td style="width: 50px;">Optional</td>
		</tr>
		<tr>
			<td>includeElement</td>
			<td>true</td>
			<td>Optional</td>
		</tr>
		<tr>
			<td>includeProcessingInstructions</td>
			<td>true</td>
			<td>Optional</td>
		</tr>
		<tr>
			<td>includeText</td>
			<td>true</td>
			<td>Optional</td>
		</tr>
	</tbody>
</table>
<h2>&lt;ValueLimits&gt; element</h2>
<p>Specifies character limits for values to be checked and enforced by the policy.</p>
<pre>
&lt;ValueLimits&gt;
   &lt;Text&gt;15&lt;/Text&gt;
   &lt;Attribute&gt;10&lt;/Attribute&gt;
   &lt;NamespaceURI&gt;10&lt;/NamespaceURI&gt;
   &lt;Comment&gt;10&lt;/Comment&gt;
   &lt;ProcessingInstructionData&gt;10&lt;/ProcessingInstructionData&gt;
&lt;/ValueLimits&gt;</pre>
<table class="pd-table">
	<tbody>
		<tr>
			<td class="pd-td-left">Default:</td>
			<td class="pd-td-right">N/A</td>
		</tr>
		<tr>
			<td class="pd-td-left">Presence:</td>
			<td class="pd-td-right">Optional</td>
		</tr>
		<tr>
			<td class="pd-td-left">Type:</td>
			<td class="pd-td-right">
				<p>N/A</p>
			</td>
		</tr>
	</tbody>
</table>
<h2>&lt;ValueLimits&gt;/&lt;Text&gt; element</h2>
<p>Specifies a character limit for any text nodes present in the XML document.</p>
<p>For example, consider the following XML:</p>
<pre>
&lt;book category="WEB"&gt;
   &lt;title&gt;Learning XML&lt;/title&gt;
   &lt;author&gt;Erik T. Ray&lt;/author&gt;
   &lt;year&gt;2003&lt;/year&gt;
&lt;/book&gt;</pre>
When analyzing the XML above, the <code>&lt;Text&gt;</code> element value in the policy snippet below will validate that the element text values <code>Learning XML</code>, <code>Erik T. Ray,</code> and <code>2003</code> do not exceed <code>15</code> characters each.
<pre>
&lt;ValueLimits&gt;
   &lt;Text&gt;15&lt;/Text&gt;
   &lt;Attribute&gt;10&lt;/Attribute&gt;
   &lt;NamespaceURI&gt;10&lt;/NamespaceURI&gt;
   &lt;Comment&gt;10&lt;/Comment&gt;
   &lt;ProcessingInstructionData&gt;10&lt;/ProcessingInstructionData&gt;
&lt;/ValueLimits&gt;</pre>
<table class="pd-table">
	<tbody>
		<tr>
			<td class="pd-td-left">Default:</td>
			<td class="pd-td-right">If you do not specify a limit, the system applies a default value of <code>-1</code>, which the system equates to no limit.</td>
		</tr>
		<tr>
			<td class="pd-td-left">Presence:</td>
			<td class="pd-td-right">Optional</td>
		</tr>
		<tr>
			<td class="pd-td-left">Type:</td>
			<td class="pd-td-right">
				<p>Integer</p>
			</td>
		</tr>
	</tbody>
</table>
<h2>&lt;ValueLimits&gt;/&lt;Attribute&gt; element</h2>
<p>Specifies a character limit for any attribute values present in the XML document.</p>
<p>For example, consider the following XML:</p>
<pre>
&lt;book category="WEB"&gt;
   &lt;title&gt;Learning XML&lt;/title&gt;
   &lt;author&gt;Erik T. Ray&lt;/author&gt;
   &lt;year&gt;2003&lt;/year&gt;
&lt;/book&gt;</pre>
When analyzing the XML above, the <code>&lt;Attribute&gt;</code> element value in the policy snippet below will validate that the attribute value <code>WEB</code> does not exceed <code>10</code> characters.
<pre>
&lt;ValueLimits&gt;
   &lt;Text&gt;15&lt;/Text&gt;
   &lt;Attribute&gt;10&lt;/Attribute&gt;
   &lt;NamespaceURI&gt;10&lt;/NamespaceURI&gt;
   &lt;Comment&gt;10&lt;/Comment&gt;
   &lt;ProcessingInstructionData&gt;10&lt;/ProcessingInstructionData&gt;
&lt;/ValueLimits&gt;</pre>
<table class="pd-table">
	<tbody>
		<tr>
			<td class="pd-td-left">Default:</td>
			<td class="pd-td-right">If you do not specify a limit, the system applies a default value of <code>-1</code>, which the system equates to no limit.</td>
		</tr>
		<tr>
			<td class="pd-td-left">Presence:</td>
			<td class="pd-td-right">Optional</td>
		</tr>
		<tr>
			<td class="pd-td-left">Type:</td>
			<td class="pd-td-right">
				<p>Integer</p>
			</td>
		</tr>
	</tbody>
</table>
<h2>&lt;ValueLimits&gt;/&lt;NamespaceURI&gt; element</h2>
<p>Specifies a character limit for any namespace URIs present in the XML document.</p>
<p>For example, consider the following XML:</p>
<pre>
&lt;ns1:myelem xmlns:ns1="http://ns1.com"/&gt;</pre>
When analyzing the XML above, the <code>&lt;NamespaceURI&gt;</code> element value in the policy snippet below will validate that the namespace URI value <code>http://ns1.com</code> does not exceed <code>10</code> characters.
<pre>
&lt;ValueLimits&gt;
   &lt;Text&gt;15&lt;/Text&gt;
   &lt;Attribute&gt;10&lt;/Attribute&gt;
   &lt;NamespaceURI&gt;10&lt;/NamespaceURI&gt;
   &lt;Comment&gt;10&lt;/Comment&gt;
   &lt;ProcessingInstructionData&gt;10&lt;/ProcessingInstructionData&gt;
&lt;/ValueLimits&gt;</pre>
<table class="pd-table">
	<tbody>
		<tr>
			<td class="pd-td-left">Default:</td>
			<td class="pd-td-right">If you do not specify a limit, the system applies a default value of <code>-1</code>, which the system equates to no limit.</td>
		</tr>
		<tr>
			<td class="pd-td-left">Presence:</td>
			<td class="pd-td-right">Optional</td>
		</tr>
		<tr>
			<td class="pd-td-left">Type:</td>
			<td class="pd-td-right">
				<p>Integer</p>
			</td>
		</tr>
	</tbody>
</table>
<h2>&lt;ValueLimits&gt;/&lt;Comment&gt; element</h2>
<p>Specifies a character limit for any comments present in the XML document.</p>
<p>For example, consider the following XML:</p>
<pre>
&lt;book category="WEB"&gt;
   &lt;!-- This is a comment --&gt;
   &lt;title&gt;Learning XML&lt;/title&gt;
   &lt;author&gt;Erik T. Ray&lt;/author&gt;
   &lt;year&gt;2003&lt;/year&gt;
&lt;/book&gt;</pre>
When analyzing the XML above, the <code>&lt;Comment&gt;</code> element value in the policy snippet below will validate that the comment text <code>This is a comment</code> does not exceed <code>10</code> characters.
<pre>
&lt;ValueLimits&gt;
   &lt;Text&gt;15&lt;/Text&gt;
   &lt;Attribute&gt;10&lt;/Attribute&gt;
   &lt;NamespaceURI&gt;10&lt;/NamespaceURI&gt;
   &lt;Comment&gt;10&lt;/Comment&gt;
   &lt;ProcessingInstructionData&gt;10&lt;/ProcessingInstructionData&gt;
&lt;/ValueLimits&gt;</pre>
<table class="pd-table">
	<tbody>
		<tr>
			<td class="pd-td-left">Default:</td>
			<td class="pd-td-right">If you do not specify a limit, the system applies a default value of <code>-1</code>, which the system equates to no limit.</td>
		</tr>
		<tr>
			<td class="pd-td-left">Presence:</td>
			<td class="pd-td-right">Optional</td>
		</tr>
		<tr>
			<td class="pd-td-left">Type:</td>
			<td class="pd-td-right">
				<p>Integer</p>
			</td>
		</tr>
	</tbody>
</table>
<h2>&lt;ValueLimits&gt;/&lt;ProcessingInstructionData&gt; element</h2>
<p>Specifies a character limit for any processing instruction text present in the XML document.</p>
<p>For example, consider the following XML:</p>
<pre>
&lt;?xml-stylesheet type="text/xsl" href="style.xsl"?&gt;</pre>
When analyzing the XML above, the <code>&lt;ProcessingInstructionData&gt;</code> element value in the policy snippet below will validate that the processing instruction text <code>type="text/xsl" href="style.xsl"</code> does not exceed <code>10</code> characters.
<pre>
&lt;ValueLimits&gt;
   &lt;Text&gt;15&lt;/Text&gt;
   &lt;Attribute&gt;10&lt;/Attribute&gt;
   &lt;NamespaceURI&gt;10&lt;/NamespaceURI&gt;
   &lt;Comment&gt;10&lt;/Comment&gt;
   &lt;ProcessingInstructionData&gt;10&lt;/ProcessingInstructionData&gt;
&lt;/ValueLimits&gt;</pre>
<table class="pd-table">
	<tbody>
		<tr>
			<td class="pd-td-left">Default:</td>
			<td class="pd-td-right">If you do not specify a limit, the system applies a default value of <code>-1</code>, which the system equates to no limit.</td>
		</tr>
		<tr>
			<td class="pd-td-left">Presence:</td>
			<td class="pd-td-right">Optional</td>
		</tr>
		<tr>
			<td class="pd-td-left">Type:</td>
			<td class="pd-td-right">
				<p>Integer</p>
			</td>
		</tr>
	</tbody>
</table>
<h2 id="errorcodes">Error codes</h2>
<p>Errors returned from Edge policies follow a consistent format as described in the <a href="http://docs.apigee.com/api-services/content/error-code-reference">Error code reference</a>.</p>
<p><a href="http://docs.apigee.com/node/21436">Content to be inserted here</a></p>
<h2 id="schemas">Schemas</h2>
<div class="sample-github">
	<p>See our <a href="https://github.com/apigee/api-platform-samples/tree/master/schemas/policy">GitHub repository</a>&nbsp;samples for the most recent schemas.</p>
</div>
<h2 id="usagenotes">Usage notes</h2>
<p>Any server that receives online data is subject to attack, whether malicious or unintentional. Some attacks take advantage of the flexibility of XML by constructing invalid documents that have the potential to compromise back-end systems. Corrupt or extremely complex XML documents can cause servers to allocate more memory than is available, tying up CPU and memory resources, crashing parsers, and generally disabling message processing and creating application-level denial-of-service attacks.</p>
<h3>Threat protection error configuration</h3>
<p>By default, Edge throws an HTTP 500 Internal Server Error status code and an ExecutionFailed error if a message doesn't make it past a JSON or XML Threat Protection policy. You can change that error behavior with a new organization-level property. When setting org property&nbsp;<code>features.isPolicyHttpStatusEnabled</code>&nbsp;to true, the following behavior occurs:</p>
<ul>
	<li>Request: With a threat protection policy attached to any request flow, invalid messages return a 400 status code, along with a corresponding policy error message.</li>
	<li>Response: With a threat protection policy attached to any response flow, invalid messages still return a 500 status code, and one of the corresponding policy error messages is thrown (rather than just ExecutionFailed).</li>
</ul>
<p>Cloud customers must contact&nbsp;<a href="http://community.apigee.com/page/apigee-customer-support">Apigee Support</a>&nbsp;to set the organization property.</p>
<div class="opdk">
	<p>Private Cloud customers can set the property with an API call like the following.</p>
	<div class="warning">
		<p>When doing a PUT to update organization properties, be sure to include all existing properties in the call to prevent wiping them out.</p>
	</div>
	<pre>
curl -u email:password -X POST -H "Content-type:application/xml" http://host:8080/v1/o/myorg -d \
"&lt;Organization type="trial" name="MyOrganization"&gt;
    &lt;Environments/&gt;
    &lt;Properties&gt;
        &lt;Property name="features.isPolicyHttpStatusEnabled"&gt;true&lt;/Property&gt;
        ...
    &lt;/Properties&gt;
&lt;/Organization&gt;"
</pre>
</div>
<h2 id="relatedtopics">Related topics</h2>
<p><a href="http://docs.apigee.com/node/365">http://docs.apigee.com/node/365</a></p>
<p><a href="http://docs.apigee.com/node/261">http://docs.apigee.com/node/261</a></p>
<p>&nbsp;</p>
